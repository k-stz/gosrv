<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>htmx XSS Demo</title>
  <script src="https://cdn.jsdelivr.net/npm/htmx.org@2.0.6/dist/htmx.min.js" integrity="sha384-Akqfrbj/HpNVo8k11SXBb6TlBWmXXlYQrCSqEWmyKJe+hDm3Z/B2WVG4smwBkRVm" crossorigin="anonymous"></script>
</head>
<body>
<h1>htmx Reflected XSS Demo</h1>

<h2>What is Reflected Cross-Site Scripting (XSS)?</h2>

<p>
Reflected cross-site scripting is one of the three main types of cross-site scripting vulnerabilities. A website is vulnerable to reflected XSS when it takes user input, such as the input from the form below, and returns it <b>unsanitized</b> in an HTML response. This allows an attacker to inject HTML, CSS, or JavaScript code and have it executed in the victimâ€™s browser.
</p>

<p>
It is called <i>reflected</i> because the user input is reflected back to the user unchanged in the HTTP response.
</p>

<p>
What attack scenarios are possible? When the input parameters are GET parameters, an attacker can craft a link to the website that contains their malicious code directly in the URL. For example, the link below points to an endpoint that reads input from the GET parameter <code>q</code> and <i>reflects</i> it completely unfiltered:
<br>
<a href="http://localhost:5000/echo?q=%3Cimg%20src%3D%22https%3A%2F%2Fupload.wikimedia.org%2Fwikipedia%2Fcommons%2Fthumb%2F3%2F31%2FNetherlandwarf.jpg%2F960px-Netherlandwarf.jpg%22%20style%3D%22width%3A%20100px%22%3E">ðŸ‘‰ Show reflected XSS example</a>
</p>

  <p>Type something below:</p>


  <input
    type="text"
    name="q"
    hx-get="/echo"
    hx-trigger="keyup changed delay:300ms"
    hx-target="#output"
  >

  <h2>Output:</h2>
  <div id="output">
    <!-- Server response gets swapped here -->
  </div>

<footer>Hint: Try to use HTML tags to see it being rendered by the browser.</footer>

<h1>Stored XSS Example</h2>

<p>Stored Cross-Site Scripting (XSS) is an attack against a web application in which user-supplied input is persistently stored by the application (for example, in comments, forum posts, or user profiles) and later rendered in a victimâ€™s browser without proper output encoding or sanitization.</p>

<p>If the application treats this stored input as trusted HTML, an attacker can embed malicious JavaScript. When another user views the affected content, the malicious script executes in the context of the vulnerable site.</p>

<p>Add a comment below, and try to input HTML, CSS or JavaScript. This time it will be presistet and anyone who visits this site will have this code loaded. This makes this kind of attack more severe than a reflected XSS, as no specifically crafted link is necessary.</p>

<p> Hint: add a comment with html, for example &lt;img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/31/Netherlandwarf.jpg/500px-Netherlandwarf.jpg"&gt;</p>

<div class="comments-section">

  <!-- Add new comment -->
  <form
    hx-post="/comments/add"
    hx-target="#comments"
    hx-swap="innerHTML"
    class="comment-form"
  >
    <input
      type="text"
      name="content"
      placeholder="Write a commentâ€¦"
      required
      class="comment-input"
    />
    <button type="submit" class="comment-submit">
      ðŸ’¬ Add Comment
    </button>
  </form>

  <!-- Comments list -->
  <div
    id="comments"
    hx-get="/comments"
    hx-trigger="load, commentAdded from:body"
    hx-swap="innerHTML"
  >
    No Comments yet
    <!-- comments.tmpl will be rendered here -->
  </div>

</div>

</body>
</html>
